
divide:
    IPUSH FP
    MOV FP, SP
    
    LOAD [FP-4]     // Load b
    IPUSH 0
    EQ              // Compare b == 0
    JZ no_exception
    
    // Throw exception
    IPUSH exception_handler
    JMP
    
no_exception:
    LOAD [FP-8]     // Load a
    LOAD [FP-4]     // Load b
    IDIV             // Divide
    
    MOV SP, FP
    IPOP FP
    RET
